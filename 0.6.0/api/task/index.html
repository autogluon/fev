
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A lightweight library for benchmarking time series forecasting models">
      
      
      
        <link rel="canonical" href="https://autogluon.github.io/fev/0.6.0/api/task/">
      
      
        <link rel="prev" href="../../tutorials/04-models/">
      
      
        <link rel="next" href="../evaluation-window/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Task - fev</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="fev" class="md-header__button md-logo" aria-label="fev" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            fev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/autogluon/fev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    autogluon/fev
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="fev" class="md-nav__button md-logo" aria-label="fev" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    fev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/autogluon/fev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    autogluon/fev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/01-quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/02-dataset-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/03-tasks-and-benchmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tasks & Benchmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/04-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Task
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Task
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fev.Task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fev.Task-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fev.Task.predictions_schema" class="md-nav__link">
    <span class="md-ellipsis">
      predictions_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.freq" class="md-nav__link">
    <span class="md-ellipsis">
      freq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.cutoffs" class="md-nav__link">
    <span class="md-ellipsis">
      cutoffs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.target_columns" class="md-nav__link">
    <span class="md-ellipsis">
      target_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.is_multivariate" class="md-nav__link">
    <span class="md-ellipsis">
      is_multivariate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.dynamic_columns" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic_columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fev.Task.get_window" class="md-nav__link">
    <span class="md-ellipsis">
      get_window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.iter_windows" class="md-nav__link">
    <span class="md-ellipsis">
      iter_windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.evaluation_summary" class="md-nav__link">
    <span class="md-ellipsis">
      evaluation_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.clean_and_validate_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      clean_and_validate_predictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.load_full_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      load_full_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation-window/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EvaluationWindow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analysis methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utility methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fev.Task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Task">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fev.Task-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fev.Task.predictions_schema" class="md-nav__link">
    <span class="md-ellipsis">
      predictions_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.freq" class="md-nav__link">
    <span class="md-ellipsis">
      freq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.cutoffs" class="md-nav__link">
    <span class="md-ellipsis">
      cutoffs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.target_columns" class="md-nav__link">
    <span class="md-ellipsis">
      target_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.is_multivariate" class="md-nav__link">
    <span class="md-ellipsis">
      is_multivariate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.dynamic_columns" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic_columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fev.Task.get_window" class="md-nav__link">
    <span class="md-ellipsis">
      get_window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.iter_windows" class="md-nav__link">
    <span class="md-ellipsis">
      iter_windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.evaluation_summary" class="md-nav__link">
    <span class="md-ellipsis">
      evaluation_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.clean_and_validate_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      clean_and_validate_predictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.load_full_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      load_full_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fev.Task.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      to_dict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="task">Task</h1>


<div class="doc doc-object doc-class">



<h2 id="fev.Task" class="doc doc-heading">
            <code>Task</code>


</h2>


    <div class="doc doc-contents first">


        <p>A univariate or multivariate time series forecasting task.</p>
<p>A <code>Task</code> stores all information uniquely identifying the task, such as path to the dataset, forecast horizon,
evaluation metric and names of the target &amp; covariate columns.</p>
<p>This object handles dataset loading, train/test splitting, and prediction evaluation for time series forecasting tasks.</p>
<p>A single <code>Task</code> consists of one or more <a class="autorefs autorefs-internal" title="EvaluationWindow


  
      dataclass
  " href="../evaluation-window/#fev.EvaluationWindow"><code>EvaluationWindow</code></a> objects that can be
accessed using <a class="autorefs autorefs-internal" title="iter_windows(storage_options: dict | None = None, trust_remote_code: bool | None = None, num_proc: int = DEFAULT_NUM_PROC) -> Iterable[EvaluationWindow]" href="#fev.Task.iter_windows"><code>iter_windows()</code></a> or <a class="autorefs autorefs-internal" title="get_window(window_idx: int, storage_options: dict | None = None, trust_remote_code: bool | None = None, num_proc: int = DEFAULT_NUM_PROC) -> EvaluationWindow" href="#fev.Task.get_window"><code>get_window()</code></a> methods.
After making predictions for each evaluation window, you can evaluate their accuracy using <a class="autorefs autorefs-internal" title="evaluation_summary(predictions_per_window: Iterable[datasets.Dataset | list[dict] | datasets.DatasetDict | dict[str, list[dict]]], model_name: str, training_time_s: float | None = None, inference_time_s: float | None = None, trained_on_this_dataset: bool = False, extra_info: dict | None = None) -> dict[str, Any]" href="#fev.Task.evaluation_summary"><code>evaluation_summary()</code></a>.</p>
<p>Typical workflow:
<div class="highlight"><pre><span></span><code><span class="n">task</span> <span class="o">=</span> <span class="n">fev</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="n">dataset_path</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">num_windows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>

<span class="n">predictions_per_window</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">iter_windows</span><span class="p">():</span>
    <span class="n">past_data</span><span class="p">,</span> <span class="n">future_data</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_input_data</span><span class="p">()</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">past_data</span><span class="p">,</span> <span class="n">future_data</span><span class="p">)</span>
    <span class="n">predictions_per_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

<span class="n">summary</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">evaluation_summary</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;my_model&quot;</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the time series dataset stored locally, on S3, or on Hugging Face Hub. See the Examples section below
for information on how to load datasets from different sources.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_config</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the configuration used when loading datasets from Hugging Face Hub. If <code>dataset_config</code> is provided,
the datasets will be loaded from HF Hub. If <code>dataset_config=None</code>, the dataset will be loaded from a local or
S3 path.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>horizon</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of the forecast horizon (in time steps).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_windows</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rolling evaluation windows included in the task.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_cutoff</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting position for the first evaluation window that separates past from future data.</p>
<p>Can be specified as:</p>
<ul>
<li><em>Integer</em>: Index position using Python indexing. <code>y[:initial_cutoff]</code> becomes the past/training data,
    and <code>y[initial_cutoff:initial_cutoff+horizon]</code> becomes the first forecast horizon to predict.
    Negative values are interpreted as steps from the end of the series.</li>
<li><em>Timestamp string</em>: Date or datetime (e.g., <code>"2024-02-01"</code>). Data up to and including this timestamp becomes
    past data, and the next <code>horizon</code> observations become the first forecast horizon.</li>
</ul>
<p>If <code>None</code>, defaults to <code>-horizon - (num_windows - 1) * window_step_size</code>.</p>
<p><strong>Note</strong>: Time series that are too short for any evaluation window (i.e., have fewer than <code>min_context_length</code>
observations before a cutoff or fewer than <code>horizon</code> observations after a cutoff) will be filtered out during
data loading.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_step_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Step size between consecutive evaluation windows. Must be an integer if <code>initial_cutoff</code> is an integer.
Can be an integer or pandas offset string (e.g., <code>'D'</code>, <code>'15min'</code>) if <code>initial_cutoff</code> is a timestamp.
Defaults to <code>horizon</code>.</p>
              </div>
            </td>
            <td>
                  <code>horizon</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_context_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series with fewer than <code>min_context_length</code> observations before a cutoff will be ignored during evaluation.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_context_length</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, the past time series will be shortened to at most this many observations.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seasonality</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seasonal period of the dataset (e.g., 24 for hourly data, 12 for monthly data). This parameter is used when
computing metrics like Mean Absolute Scaled Error (MASE).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eval_metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation metric used for ultimate evaluation on the test set. Can be specified as either a single string
with the metric's name or a dictionary containing a "name" key and extra hyperparameters for the metric.
For example, MASE can also be specified as <code>{"name": "MASE", "epsilon": 0.0001}</code> to prevent zero
denominators when scaling errors.</p>
              </div>
            </td>
            <td>
                  <code>&#39;MASE&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_metrics</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional metrics to be included in the results. Can be specified as a list of strings with the metric's
name or a list of dictionaries. See documentation for <code>eval_metric</code> for more details.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quantile_levels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Quantiles that must be predicted. List of floats between 0 and 1 (for example, <code>[0.1, 0.5, 0.9]</code>).</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>id_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column with the unique identifier of each time series.
This column will be casted to <code>string</code> dtype and the dataset will be sorted according to it.</p>
              </div>
            </td>
            <td>
                  <code>&#39;id&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timestamp_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column with the timestamps of the observations.</p>
              </div>
            </td>
            <td>
                  <code>&#39;timestamp&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column that must be predicted. If a string is provided, a univariate forecasting task is created.
If a list of strings is provided, a multivariate forecasting task is created.</p>
              </div>
            </td>
            <td>
                  <code>&#39;target&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>generate_univariate_targets_from</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="typing.Literal">Literal</span>[&#39;__ALL__&#39;] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, a separate univariate time series will be created from each of the
<code>generate_univariate_targets_from</code> columns. Only valid for univariate tasks.</p>
<p>If set to <code>"__ALL__"</code>, then a separate univariate instance will be created from each column of type <code>Sequence</code>.</p>
<p>For example, if <code>generate_univariate_targets_from = ["X", "Y"]</code> then the raw multivariate time series
<code>{"id": "A", "timestamp": [...], "X": [...], "Y": [...]}</code> will be split into two univariate time series
<code>{"id": "A_X", "timestamp": [...], "target": [...]}</code> and <code>{"id": "A_Y", "timestamp": [...], "target": [...]}</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>past_dynamic_columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of covariate columns that are known only in the past. These will be available in the past data, but not
in the future data. An error will be raised if these columns are missing from the dataset.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>known_dynamic_columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of covariate columns that are known in both past and future. These will be available in past data
and future data. An error will be raised if these columns are missing from the dataset.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>static_columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of columns containing static covariates that don't change over time. An error will be raised if these
columns are missing from the dataset.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Human-readable name for the task. Defaults to <code>dataset_config</code> for datasets stored on HF hub, and to the
name of 2 parent directories for local or S3-based datasets.</p>
<p>This field is only here for convenience and is not used for any validation when computing the results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Dataset stored on the Hugging Face Hub</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Task</span><span class="p">(</span><span class="n">dataset_path</span><span class="o">=</span><span class="s2">&quot;autogluon/chronos_datasets&quot;</span><span class="p">,</span> <span class="n">dataset_config</span><span class="o">=</span><span class="s2">&quot;m4_hourly&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div>
    <p>Dataset stored as a parquet file (local or S3)</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Task</span><span class="p">(</span><span class="n">dataset_path</span><span class="o">=</span><span class="s2">&quot;s3://my-bucket/m4_hourly/data.parquet&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div>
    <p>Dataset consisting of multiple parquet files (local or S3)</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">Task</span><span class="p">(</span><span class="n">dataset_path</span><span class="o">=</span><span class="s2">&quot;s3://my-bucket/m4_hourly/*.parquet&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div>








              <details class="quote">
                <summary>Source code in <code>src/fev/task.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pydantic</span><span class="o">.</span><span class="n">dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;extra&quot;</span><span class="p">:</span> <span class="s2">&quot;forbid&quot;</span><span class="p">})</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Task</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A univariate or multivariate time series forecasting task.</span>

<span class="sd">    A `Task` stores all information uniquely identifying the task, such as path to the dataset, forecast horizon,</span>
<span class="sd">    evaluation metric and names of the target &amp; covariate columns.</span>

<span class="sd">    This object handles dataset loading, train/test splitting, and prediction evaluation for time series forecasting tasks.</span>

<span class="sd">    A single `Task` consists of one or more [`EvaluationWindow`][fev.task.EvaluationWindow] objects that can be</span>
<span class="sd">    accessed using [`iter_windows()`][fev.Task.iter_windows] or [`get_window()`][fev.Task.get_window] methods.</span>
<span class="sd">    After making predictions for each evaluation window, you can evaluate their accuracy using [`evaluation_summary()`][fev.Task.evaluation_summary].</span>

<span class="sd">    Typical workflow:</span>
<span class="sd">    ```python</span>
<span class="sd">    task = fev.Task(dataset_path=&quot;...&quot;, num_windows=3, horizon=24)</span>

<span class="sd">    predictions_per_window = []</span>
<span class="sd">    for window in task.iter_windows():</span>
<span class="sd">        past_data, future_data = window.get_input_data()</span>
<span class="sd">        predictions = model.predict(past_data, future_data)</span>
<span class="sd">        predictions_per_window.append(predictions)</span>

<span class="sd">    summary = task.evaluation_summary(predictions_per_window, model_name=&quot;my_model&quot;)</span>
<span class="sd">    ```</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataset_path : str</span>
<span class="sd">        Path to the time series dataset stored locally, on S3, or on Hugging Face Hub. See the Examples section below</span>
<span class="sd">        for information on how to load datasets from different sources.</span>
<span class="sd">    dataset_config : str | None, default None</span>
<span class="sd">        Name of the configuration used when loading datasets from Hugging Face Hub. If `dataset_config` is provided,</span>
<span class="sd">        the datasets will be loaded from HF Hub. If `dataset_config=None`, the dataset will be loaded from a local or</span>
<span class="sd">        S3 path.</span>
<span class="sd">    horizon : int, default 1</span>
<span class="sd">        Length of the forecast horizon (in time steps).</span>
<span class="sd">    num_windows : int, default 1</span>
<span class="sd">        Number of rolling evaluation windows included in the task.</span>
<span class="sd">    initial_cutoff : int | str | None, default None</span>
<span class="sd">        Starting position for the first evaluation window that separates past from future data.</span>

<span class="sd">        Can be specified as:</span>

<span class="sd">        - *Integer*: Index position using Python indexing. `y[:initial_cutoff]` becomes the past/training data,</span>
<span class="sd">            and `y[initial_cutoff:initial_cutoff+horizon]` becomes the first forecast horizon to predict.</span>
<span class="sd">            Negative values are interpreted as steps from the end of the series.</span>
<span class="sd">        - *Timestamp string*: Date or datetime (e.g., `&quot;2024-02-01&quot;`). Data up to and including this timestamp becomes</span>
<span class="sd">            past data, and the next `horizon` observations become the first forecast horizon.</span>

<span class="sd">        If `None`, defaults to `-horizon - (num_windows - 1) * window_step_size`.</span>

<span class="sd">        **Note**: Time series that are too short for any evaluation window (i.e., have fewer than `min_context_length`</span>
<span class="sd">        observations before a cutoff or fewer than `horizon` observations after a cutoff) will be filtered out during</span>
<span class="sd">        data loading.</span>
<span class="sd">    window_step_size : int | str | None, default horizon</span>
<span class="sd">        Step size between consecutive evaluation windows. Must be an integer if `initial_cutoff` is an integer.</span>
<span class="sd">        Can be an integer or pandas offset string (e.g., `&#39;D&#39;`, `&#39;15min&#39;`) if `initial_cutoff` is a timestamp.</span>
<span class="sd">        Defaults to `horizon`.</span>
<span class="sd">    min_context_length : int, default 1</span>
<span class="sd">        Time series with fewer than `min_context_length` observations before a cutoff will be ignored during evaluation.</span>
<span class="sd">    max_context_length : int | None, default None</span>
<span class="sd">        If provided, the past time series will be shortened to at most this many observations.</span>
<span class="sd">    seasonality : int, default 1</span>
<span class="sd">        Seasonal period of the dataset (e.g., 24 for hourly data, 12 for monthly data). This parameter is used when</span>
<span class="sd">        computing metrics like Mean Absolute Scaled Error (MASE).</span>
<span class="sd">    eval_metric : str | dict[str, Any], default &#39;MASE&#39;</span>
<span class="sd">        Evaluation metric used for ultimate evaluation on the test set. Can be specified as either a single string</span>
<span class="sd">        with the metric&#39;s name or a dictionary containing a &quot;name&quot; key and extra hyperparameters for the metric.</span>
<span class="sd">        For example, MASE can also be specified as `{&quot;name&quot;: &quot;MASE&quot;, &quot;epsilon&quot;: 0.0001}` to prevent zero</span>
<span class="sd">        denominators when scaling errors.</span>
<span class="sd">    extra_metrics : list[str] | list[dict[str, Any]], default []</span>
<span class="sd">        Additional metrics to be included in the results. Can be specified as a list of strings with the metric&#39;s</span>
<span class="sd">        name or a list of dictionaries. See documentation for `eval_metric` for more details.</span>
<span class="sd">    quantile_levels : list[float], default []</span>
<span class="sd">        Quantiles that must be predicted. List of floats between 0 and 1 (for example, `[0.1, 0.5, 0.9]`).</span>
<span class="sd">    id_column : str, default &#39;id&#39;</span>
<span class="sd">        Name of the column with the unique identifier of each time series.</span>
<span class="sd">        This column will be casted to `string` dtype and the dataset will be sorted according to it.</span>
<span class="sd">    timestamp_column : str, default &#39;timestamp&#39;</span>
<span class="sd">        Name of the column with the timestamps of the observations.</span>
<span class="sd">    target : str | list[str], default &#39;target&#39;</span>
<span class="sd">        Name of the column that must be predicted. If a string is provided, a univariate forecasting task is created.</span>
<span class="sd">        If a list of strings is provided, a multivariate forecasting task is created.</span>
<span class="sd">    generate_univariate_targets_from : list[str] | Literal[&quot;__ALL__&quot;] | None, default None</span>
<span class="sd">        If provided, a separate univariate time series will be created from each of the</span>
<span class="sd">        `generate_univariate_targets_from` columns. Only valid for univariate tasks.</span>

<span class="sd">        If set to `&quot;__ALL__&quot;`, then a separate univariate instance will be created from each column of type `Sequence`.</span>

<span class="sd">        For example, if `generate_univariate_targets_from = [&quot;X&quot;, &quot;Y&quot;]` then the raw multivariate time series</span>
<span class="sd">        `{&quot;id&quot;: &quot;A&quot;, &quot;timestamp&quot;: [...], &quot;X&quot;: [...], &quot;Y&quot;: [...]}` will be split into two univariate time series</span>
<span class="sd">        `{&quot;id&quot;: &quot;A_X&quot;, &quot;timestamp&quot;: [...], &quot;target&quot;: [...]}` and `{&quot;id&quot;: &quot;A_Y&quot;, &quot;timestamp&quot;: [...], &quot;target&quot;: [...]}`.</span>
<span class="sd">    past_dynamic_columns : list[str], default []</span>
<span class="sd">        Names of covariate columns that are known only in the past. These will be available in the past data, but not</span>
<span class="sd">        in the future data. An error will be raised if these columns are missing from the dataset.</span>
<span class="sd">    known_dynamic_columns : list[str], default []</span>
<span class="sd">        Names of covariate columns that are known in both past and future. These will be available in past data</span>
<span class="sd">        and future data. An error will be raised if these columns are missing from the dataset.</span>
<span class="sd">    static_columns : list[str], default []</span>
<span class="sd">        Names of columns containing static covariates that don&#39;t change over time. An error will be raised if these</span>
<span class="sd">        columns are missing from the dataset.</span>
<span class="sd">    task_name : str | None, default None</span>
<span class="sd">        Human-readable name for the task. Defaults to `dataset_config` for datasets stored on HF hub, and to the</span>
<span class="sd">        name of 2 parent directories for local or S3-based datasets.</span>

<span class="sd">        This field is only here for convenience and is not used for any validation when computing the results.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Dataset stored on the Hugging Face Hub</span>

<span class="sd">    &gt;&gt;&gt; Task(dataset_path=&quot;autogluon/chronos_datasets&quot;, dataset_config=&quot;m4_hourly&quot;, ...)</span>

<span class="sd">    Dataset stored as a parquet file (local or S3)</span>

<span class="sd">    &gt;&gt;&gt; Task(dataset_path=&quot;s3://my-bucket/m4_hourly/data.parquet&quot;, ...)</span>

<span class="sd">    Dataset consisting of multiple parquet files (local or S3)</span>

<span class="sd">    &gt;&gt;&gt; Task(dataset_path=&quot;s3://my-bucket/m4_hourly/*.parquet&quot;, ...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dataset_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Forecast horizon parameters</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_windows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">initial_cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">window_step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">min_context_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">max_context_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Evaluation parameters</span>
    <span class="n">seasonality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">eval_metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MASE&quot;</span>
    <span class="n">extra_metrics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">quantile_levels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="c1"># Feature information</span>
    <span class="n">id_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span>
    <span class="n">timestamp_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;timestamp&quot;</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;target&quot;</span>
    <span class="n">generate_univariate_targets_from</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;__ALL__&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">known_dynamic_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">past_dynamic_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">static_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># HF Hub dataset -&gt; name of dataset_config</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">task_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># File dataset -&gt; names of up to 2 parent directories</span>
                <span class="c1"># e.g. /home/foo/bar/data.parquet -&gt; foo/bar</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">task_name</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_path</span><span class="p">)</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;`num_windows` must satisfy &gt;= 1&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizon</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;`window_step_size` must satisfy &gt;= 1&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">to_offset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">offset</span><span class="o">.</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;If `window_step_size` is a string, it must correspond to a positive timedelta&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span> <span class="o">=</span> <span class="n">offset</span><span class="o">.</span><span class="n">freqstr</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="p">(</span>
                <span class="s2">&quot;If `initial_cutoff` is None, `window_step_size` must be an int&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">horizon</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`window_step_size` must be an int if `initial_cutoff` is an int&quot;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span> <span class="o">&gt;=</span> <span class="mi">1</span>
            <span class="n">max_allowed_cutoff</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">horizon</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span> <span class="o">&gt;</span> <span class="n">max_allowed_cutoff</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Negative `initial_cutoff` must be &lt;= `-horizon - (num_windows - 1) * window_step_size`&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">q</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span><span class="p">),</span> <span class="s2">&quot;All quantile_levels must satisfy 0 &lt; q &lt; 1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span><span class="p">)</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_metric</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_metrics</span><span class="p">]</span>

        <span class="n">metric_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">]</span>
        <span class="n">duplicate_metric_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">metric_names</span> <span class="k">if</span> <span class="n">metric_names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">duplicate_metric_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Duplicate metric names found: </span><span class="si">{</span><span class="n">duplicate_metric_names</span><span class="si">}</span><span class="s2">. Please configure &quot;</span>
                <span class="s2">&quot;only one instance for each metric.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">needs_quantiles</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please provide quantile_levels when using a quantile metric &#39;</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_context_length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`min_context_length` must satisfy &gt;= 1&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_context_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_context_length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;If provided, `max_context_length` must satisfy &gt;= 1&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;For multivariate tasks `target` must contain at least one entry&quot;</span><span class="p">)</span>
            <span class="c1"># Ensure that column names are sorted alphabetically so that univariate adapters return sorted data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>

        <span class="c1"># Ensure that column names are sorted alphabetically for deterministic task comparison</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_multivariate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`generate_univariate_targets_from` cannot be used for multivariate tasks (when `target` is a list)&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Attributes computed after the dataset is loaded</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_fingerprint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">cutoffs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cutoffs corresponding to each `EvaluationWindow` in the task.</span>

<span class="sd">        Computed based on `num_windows`, `initial_cutoff` and `window_step_size` attributes of the task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span> <span class="o">+</span> <span class="n">window_idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span> <span class="k">for</span> <span class="n">window_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">to_offset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">to_offset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_step_size</span>

            <span class="n">cutoffs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">window_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="p">):</span>
                <span class="n">cutoff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_cutoff</span><span class="p">)</span>
                <span class="c1"># We don&#39;t add the offset for window_idx=0 to avoid applying an &quot;anchored&quot; offset</span>
                <span class="c1"># (e.g. `Timestamp(&quot;2020-01-01&quot;) + i * to_offset(&quot;ME&quot;)` returns &quot;2020-01-31&quot; for i=0 and i=1)</span>
                <span class="k">if</span> <span class="n">window_idx</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">cutoff</span> <span class="o">+=</span> <span class="n">window_idx</span> <span class="o">*</span> <span class="n">offset</span>
                <span class="n">cutoffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cutoff</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">cutoffs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert task definition to a dictionary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_full_dataset</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the full raw dataset with preprocessing applied.</span>

<span class="sd">        This method validates the data, loads and preprocesses the dataset according to the task configuration,</span>
<span class="sd">        including generating univariate targets if `generate_univariate_targets_from` is provided.</span>

<span class="sd">        **Note:** This method is only provided for information and debugging purposes. For model evaluation, use</span>
<span class="sd">        [`iter_windows()`][fev.Task.iter_windows] instead to get properly split train/test data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storage_options : dict, optional</span>
<span class="sd">            Passed to `datasets.load_dataset()` for accessing remote datasets (e.g., S3 credentials).</span>
<span class="sd">        trust_remote_code : bool, optional</span>
<span class="sd">            Passed to `datasets.load_dataset()` for trusting remote code from Hugging Face Hub.</span>
<span class="sd">        num_proc : int, default DEFAULT_NUM_PROC</span>
<span class="sd">            Number of processes to use for dataset preprocessing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        datasets.Dataset</span>
<span class="sd">            The preprocessed dataset with all time series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_dataset</span><span class="p">(</span>
                <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">iter_windows</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">EvaluationWindow</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over the rolling evaluation windows in the task.</span>

<span class="sd">        Each window contains train/test splits at different cutoff points for time series</span>
<span class="sd">        cross-validation. Use this method for model evaluation and benchmarking.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        storage_options : dict, optional</span>
<span class="sd">            Passed to `datasets.load_dataset()` for accessing remote datasets (e.g., S3 credentials).</span>
<span class="sd">        trust_remote_code : bool, optional</span>
<span class="sd">            Passed to `datasets.load_dataset()` for trusting remote code from Hugging Face Hub.</span>
<span class="sd">        num_proc : int, default DEFAULT_NUM_PROC</span>
<span class="sd">            Number of processes to use for dataset preprocessing.</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        EvaluationWindow</span>
<span class="sd">            A single evaluation window at a specific cutoff containing the data needed to make and evaluate forecasts.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; for window in task.iter_windows():</span>
<span class="sd">        ...     past_data, future_data = window.get_input_data()</span>
<span class="sd">        ...     # Make predictions using past_data and future_data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">window_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="p">):</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span>
                <span class="n">window_idx</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_window</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationWindow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a single evaluation window by index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        window_idx : int</span>
<span class="sd">            Index of the evaluation window in [0, 1, ..., num_windows - 1].</span>
<span class="sd">        storage_options : dict, optional</span>
<span class="sd">            Passed to `datasets.load_dataset()` for accessing remote datasets (e.g., S3 credentials).</span>
<span class="sd">        trust_remote_code : bool, optional</span>
<span class="sd">            Passed to `datasets.load_dataset()` for trusting remote code from Hugging Face Hub.</span>
<span class="sd">        num_proc : int, default DEFAULT_NUM_PROC</span>
<span class="sd">            Number of processes to use for dataset preprocessing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        EvaluationWindow</span>
<span class="sd">            A single evaluation window at a specific cutoff containing the data needed to make and evaluate forecasts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">full_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_full_dataset</span><span class="p">(</span>
            <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">window_idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Window index </span><span class="si">{</span><span class="n">window_idx</span><span class="si">}</span><span class="s2"> is out of range (num_windows=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EvaluationWindow</span><span class="p">(</span>
            <span class="n">full_dataset</span><span class="o">=</span><span class="n">full_dataset</span><span class="p">,</span>
            <span class="n">cutoff</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoffs</span><span class="p">[</span><span class="n">window_idx</span><span class="p">],</span>
            <span class="n">horizon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">horizon</span><span class="p">,</span>
            <span class="n">min_context_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_context_length</span><span class="p">,</span>
            <span class="n">max_context_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_context_length</span><span class="p">,</span>
            <span class="n">id_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span>
            <span class="n">timestamp_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span><span class="p">,</span>
            <span class="n">target_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span><span class="p">,</span>
            <span class="n">known_dynamic_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span><span class="p">,</span>
            <span class="n">past_dynamic_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span><span class="p">,</span>
            <span class="n">static_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@pydantic</span><span class="o">.</span><span class="n">model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">handle_deprecated_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">ArgsKwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArgsKwargs</span><span class="p">:</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_warn_and_rename_kwarg</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">ArgsKwargs</span><span class="p">,</span> <span class="n">old_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArgsKwargs</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">old_name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">old_name</span><span class="si">}</span><span class="s2">&#39; is deprecated and will be removed in a future release. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Please use &#39;</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s2">&#39; instead&quot;</span><span class="p">,</span>
                    <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span>
                    <span class="n">stacklevel</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>

        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;lead_time&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span><span class="p">:</span>
                <span class="c1"># &#39;lead_time&#39; was never used before, quietly ignore</span>
                <span class="n">data</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;lead_time&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;num_rolling_windows&quot;</span><span class="p">,</span> <span class="s2">&quot;num_windows&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;rolling_step_size&quot;</span><span class="p">,</span> <span class="s2">&quot;window_step_size&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;cutoff&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_cutoff&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;target_column&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">),</span>
            <span class="p">]:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">_warn_and_rename_kwarg</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">freq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pandas string corresponding to the frequency of the time series in the dataset.</span>

<span class="sd">        See [pandas documentation](https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#cutoff-aliases)</span>
<span class="sd">        for the list of possible values.</span>

<span class="sd">        This attribute is available after the dataset is loaded with `load_full_dataset`, `iter_windows` or `get_window`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please load dataset first with `task.load_full_dataset()`&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dynamic_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of dynamic covariates available in the task. Does not include the target columns.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_dataset</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the raw dataset and apply initial preprocessing based on the Task definition.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Load dataset from HF Hub</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_path</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Load dataset from a local or remote file</span>
            <span class="n">dataset_format</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_path</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="n">allowed_formats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;arrow&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">dataset_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_formats</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When loading dataset from file, path must end in one of </span><span class="si">{</span><span class="n">allowed_formats</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">dataset_format</span>
            <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">data_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_path</span>

        <span class="k">if</span> <span class="n">storage_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">storage_options</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">load_dataset_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">data_files</span><span class="o">=</span><span class="n">data_files</span><span class="p">,</span>
            <span class="n">split</span><span class="o">=</span><span class="n">TRAIN</span><span class="p">,</span>
            <span class="n">storage_options</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">storage_options</span><span class="p">),</span>
            <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span>
                <span class="o">**</span><span class="n">load_dataset_kwargs</span><span class="p">,</span>
                <span class="c1"># PatchedDownloadConfig fixes https://github.com/huggingface/datasets/issues/6598</span>
                <span class="n">download_config</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">PatchedDownloadConfig</span><span class="p">(</span><span class="n">storage_options</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">storage_options</span><span class="p">)),</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to load the dataset when calling `datasets.load_dataset` with arguments</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">load_dataset_kwargs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Since we loaded with split=TRAIN and streaming=False, ds is a datasets.Dataset object</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>

        <span class="n">required_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">required_columns</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span> <span class="o">==</span> <span class="n">ALL_AVAILABLE_COLUMNS</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">required_columns</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span>

        <span class="n">utils</span><span class="o">.</span><span class="n">validate_time_series_dataset</span><span class="p">(</span>
            <span class="n">ds</span><span class="p">,</span>
            <span class="n">id_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span>
            <span class="n">timestamp_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span><span class="p">,</span>
            <span class="n">required_columns</span><span class="o">=</span><span class="n">required_columns</span><span class="p">,</span>
            <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Create separate instances from columns listed in `generate_univariate_targets_from`</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span> <span class="o">==</span> <span class="n">ALL_AVAILABLE_COLUMNS</span><span class="p">:</span>
                <span class="n">generate_univariate_targets_from</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">col</span>
                    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">generate_univariate_targets_from</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_univariate_targets_from</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">generate_univariate_targets_from_multivariate</span><span class="p">(</span>
                <span class="n">ds</span><span class="p">,</span>
                <span class="n">id_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span>
                <span class="n">new_target_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span>
                <span class="n">generate_univariate_targets_from</span><span class="o">=</span><span class="n">generate_univariate_targets_from</span><span class="p">,</span>
                <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Ensure that IDs are sorted alphabetically for consistent ordering</span>
        <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cast_column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Value</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">))</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset contains irregular timestamps&quot;</span><span class="p">)</span>

        <span class="n">available_dynamic_columns</span><span class="p">,</span> <span class="n">available_static_columns</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">infer_column_types</span><span class="p">(</span>
            <span class="n">ds</span><span class="p">,</span> <span class="n">id_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span> <span class="n">timestamp_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span>
        <span class="p">)</span>
        <span class="n">missing_dynamic</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">available_dynamic_columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_dynamic</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dynamic columns not found in dataset: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_dynamic</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">missing_static</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">available_static_columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_static</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Static columns not found in dataset: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_static</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_fingerprint</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">generate_fingerprint</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ds</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dataset_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;id_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span>
            <span class="s2">&quot;timestamp_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span><span class="p">,</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span>
            <span class="s2">&quot;static_columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span><span class="p">,</span>
            <span class="s2">&quot;dynamic_columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_columns</span><span class="p">,</span>
            <span class="s2">&quot;known_dynamic_columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span><span class="p">,</span>
            <span class="s2">&quot;past_dynamic_columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predictions_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Features</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Describes the format that the predictions must follow.</span>

<span class="sd">        Forecast must always include the key `&quot;predictions&quot;` corresponding to the point forecast.</span>

<span class="sd">        The predictions must also include a key for each of the `quantile_levels`.</span>
<span class="sd">        For example, if `quantile_levels = [0.1, 0.9]`, then keys `&quot;0.1&quot;` and `&quot;0.9&quot;` must be included in the forecast.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">predictions_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizon</span>
        <span class="n">predictions_schema</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">PREDICTIONS</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">Value</span><span class="p">(</span><span class="s2">&quot;float64&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="n">predictions_length</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span><span class="p">):</span>
            <span class="n">predictions_schema</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)]</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">Value</span><span class="p">(</span><span class="s2">&quot;float64&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="n">predictions_length</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Features</span><span class="p">(</span><span class="n">predictions_schema</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clean_and_validate_predictions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">|</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert predictions for a single window into the format needed for computing the metrics.</span>

<span class="sd">        The following formats are supported for both multivariate and univariate tasks:</span>

<span class="sd">        - `DatasetDict`: Must contain a single key for each target in `task.target_columns`. Each value in</span>
<span class="sd">            the dict must be a `datasets.Dataset` with schema compatible with `task.predictions_schema`. This is the</span>
<span class="sd">            recommended format for providing predictions.</span>
<span class="sd">        - `dict[str, list[dict]]`: A dictionary with one key for each target in `task.target_columns`. Each value in</span>
<span class="sd">            the dict must be a list of dictionaries, each dict following the schema in `task.predictions_schema`.</span>

<span class="sd">        Additionally for univariate tasks, the following formats are supported:</span>

<span class="sd">        - `datasets.Dataset`: A single `datasets.Dataset` with schema compatible with `task.predictions_schema`.</span>
<span class="sd">        - `list[dict]`: A list of dictionaries, where each dict follows the schema in `task.predictions_schema`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        predictions :</span>
<span class="sd">            A `DatasetDict` where each key is the name of the target column and the corresponding value is a</span>
<span class="sd">            `datasets.Dataset` with the predictions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_to_dataset</span><span class="p">(</span><span class="n">preds</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">preds</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">preds</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;`datasets.Dataset.from_list(predictions)` failed. Please convert predictions to `datasets.Dataset` format.&quot;</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;predictions must be of type `datasets.Dataset` (received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">preds</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">({</span><span class="n">col</span><span class="p">:</span> <span class="n">_to_dataset</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">preds</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)):</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">_to_dataset</span><span class="p">(</span><span class="n">predictions</span><span class="p">)})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected predictions to be a `DatasetDict`, `Dataset`, `list` or `dict` (got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">missing_columns</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing predictions for columns </span><span class="si">{</span><span class="n">missing_columns</span><span class="si">}</span><span class="s2"> (got </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predictions_schema</span><span class="p">)</span><span class="o">.</span><span class="n">with_format</span><span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">predictions_for_column</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_assert_all_columns_finite</span><span class="p">(</span><span class="n">predictions_for_column</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predictions</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_assert_all_columns_finite</span><span class="p">(</span><span class="n">predictions</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
            <span class="n">nan_row_idx</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">col</span><span class="p">])))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nan_row_idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Predictions contain NaN or Inf values. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;First invalid value encountered in column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> for item </span><span class="si">{</span><span class="n">nan_row_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">predictions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nan_row_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluation_summary</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">predictions_per_window</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]],</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">training_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inference_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trained_on_this_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">extra_info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a summary of the model performance for the given forecasting task.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        predictions_per_window : Iterable[datasets.Dataset | list[dict] | datasets.DatasetDict | dict[str, list[dict]]]</span>
<span class="sd">            Predictions generated by the model for each evaluation window in the task.</span>

<span class="sd">            The length of `predictions_per_window` must be equal to `task.num_windows`.</span>

<span class="sd">            The predictions for each window must be formatted as described in [clean_and_validate_predictions][fev.Task.clean_and_validate_predictions].</span>
<span class="sd">        model_name : str</span>
<span class="sd">            Name of the model that generated the predictions.</span>
<span class="sd">        training_time_s : float | None</span>
<span class="sd">            Training time of the model for this task (in seconds).</span>
<span class="sd">        inference_time_s : float | None</span>
<span class="sd">            Total inference time to generate all predictions (in seconds).</span>
<span class="sd">        trained_on_this_dataset : bool</span>
<span class="sd">            Was the model trained on the dataset associated with this task? Set to False if the model is used in</span>
<span class="sd">            zero-shot mode.</span>
<span class="sd">        extra_info : dict | None</span>
<span class="sd">            Optional dictionary with additional information that will be appended to the evaluation summary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : dict</span>
<span class="sd">            Dictionary that summarizes the model performance on this task. Includes following keys:</span>

<span class="sd">            - `model_name` - name of the model</span>
<span class="sd">            - `test_error` - value of the `task.eval_metric` averaged over all evaluation windows (lower is better)</span>
<span class="sd">            - all `Task` attributes obtained via `task.to_dict()`.</span>
<span class="sd">            - values of `task.extra_metrics` averaged all evaluation windows</span>
<span class="sd">            - `dataset_fingerprint` - fingerprint of the dataset generated by the HF `datasets` library</span>
<span class="sd">            - `trained_on_this_dataset` - whether the model was trained on the dataset used in the task</span>
<span class="sd">            - `fev_version` - version of the `fev` package used to obtain the summary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">}</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_metric</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_metrics</span><span class="p">]</span>
        <span class="n">eval_metric</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">metrics_per_window</span> <span class="o">=</span> <span class="p">{</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">,</span> <span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;predictions_per_window must be iterable (e.g., a list) but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Use strict=True to raise error if num_predictions does not match num_windows</span>
        <span class="k">for</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">window</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_windows</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">metric_scores</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">compute_metrics</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clean_and_validate_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span>
                <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
                <span class="n">seasonality</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seasonality</span><span class="p">,</span>
                <span class="n">quantile_levels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metric_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">metrics_per_window</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">metrics_averaged</span> <span class="o">=</span> <span class="p">{</span><span class="n">metric_name</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">metrics_per_window</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;test_error&quot;</span><span class="p">:</span> <span class="n">metrics_averaged</span><span class="p">[</span><span class="n">eval_metric</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
                <span class="s2">&quot;training_time_s&quot;</span><span class="p">:</span> <span class="n">training_time_s</span><span class="p">,</span>
                <span class="s2">&quot;inference_time_s&quot;</span><span class="p">:</span> <span class="n">inference_time_s</span><span class="p">,</span>
                <span class="s2">&quot;dataset_fingerprint&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_fingerprint</span><span class="p">,</span>
                <span class="s2">&quot;trained_on_this_dataset&quot;</span><span class="p">:</span> <span class="n">trained_on_this_dataset</span><span class="p">,</span>
                <span class="s2">&quot;fev_version&quot;</span><span class="p">:</span> <span class="n">FEV_VERSION</span><span class="p">,</span>
                <span class="o">**</span><span class="n">metrics_averaged</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra_info</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">summary</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_multivariate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns `True` if `task.target` is a `list`, `False` otherwise.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">target_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list including names of all target columns for this task.</span>

<span class="sd">        Unlike `task.target` that can be a string or a list, `task.target_columns` is always a list of strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h3 id="fev.Task-attributes">Attributes</h3>

<div class="doc doc-object doc-attribute">



<h4 id="fev.Task.predictions_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predictions_schema</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Features</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Describes the format that the predictions must follow.</p>
<p>Forecast must always include the key <code>"predictions"</code> corresponding to the point forecast.</p>
<p>The predictions must also include a key for each of the <code>quantile_levels</code>.
For example, if <code>quantile_levels = [0.1, 0.9]</code>, then keys <code>"0.1"</code> and <code>"0.9"</code> must be included in the forecast.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="fev.Task.freq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">freq</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Pandas string corresponding to the frequency of the time series in the dataset.</p>
<p>See <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#cutoff-aliases">pandas documentation</a>
for the list of possible values.</p>
<p>This attribute is available after the dataset is loaded with <code>load_full_dataset</code>, <code>iter_windows</code> or <code>get_window</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="fev.Task.cutoffs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cutoffs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Cutoffs corresponding to each <code>EvaluationWindow</code> in the task.</p>
<p>Computed based on <code>num_windows</code>, <code>initial_cutoff</code> and <code>window_step_size</code> attributes of the task.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="fev.Task.target_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">target_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A list including names of all target columns for this task.</p>
<p>Unlike <code>task.target</code> that can be a string or a list, <code>task.target_columns</code> is always a list of strings.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="fev.Task.is_multivariate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_multivariate</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns <code>True</code> if <code>task.target</code> is a <code>list</code>, <code>False</code> otherwise.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="fev.Task.dynamic_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dynamic_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of dynamic covariates available in the task. Does not include the target columns.</p>

    </div>

</div>


<h3 id="fev.Task-functions">Functions</h3>

<div class="doc doc-object doc-function">


<h4 id="fev.Task.get_window" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_window</span><span class="p">(</span><span class="n">window_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationWindow</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get a single evaluation window by index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>window_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the evaluation window in [0, 1, ..., num_windows - 1].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>storage_options</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Passed to <code>datasets.load_dataset()</code> for accessing remote datasets (e.g., S3 credentials).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trust_remote_code</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Passed to <code>datasets.load_dataset()</code> for trusting remote code from Hugging Face Hub.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_proc</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of processes to use for dataset preprocessing.</p>
              </div>
            </td>
            <td>
                  <code>DEFAULT_NUM_PROC</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EvaluationWindow


  
      dataclass
   (fev.task.EvaluationWindow)" href="../evaluation-window/#fev.EvaluationWindow">EvaluationWindow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single evaluation window at a specific cutoff containing the data needed to make and evaluate forecasts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/fev/task.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_window</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">window_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationWindow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a single evaluation window by index.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    window_idx : int</span>
<span class="sd">        Index of the evaluation window in [0, 1, ..., num_windows - 1].</span>
<span class="sd">    storage_options : dict, optional</span>
<span class="sd">        Passed to `datasets.load_dataset()` for accessing remote datasets (e.g., S3 credentials).</span>
<span class="sd">    trust_remote_code : bool, optional</span>
<span class="sd">        Passed to `datasets.load_dataset()` for trusting remote code from Hugging Face Hub.</span>
<span class="sd">    num_proc : int, default DEFAULT_NUM_PROC</span>
<span class="sd">        Number of processes to use for dataset preprocessing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    EvaluationWindow</span>
<span class="sd">        A single evaluation window at a specific cutoff containing the data needed to make and evaluate forecasts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_full_dataset</span><span class="p">(</span>
        <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">window_idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Window index </span><span class="si">{</span><span class="n">window_idx</span><span class="si">}</span><span class="s2"> is out of range (num_windows=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">EvaluationWindow</span><span class="p">(</span>
        <span class="n">full_dataset</span><span class="o">=</span><span class="n">full_dataset</span><span class="p">,</span>
        <span class="n">cutoff</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoffs</span><span class="p">[</span><span class="n">window_idx</span><span class="p">],</span>
        <span class="n">horizon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">horizon</span><span class="p">,</span>
        <span class="n">min_context_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_context_length</span><span class="p">,</span>
        <span class="n">max_context_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_context_length</span><span class="p">,</span>
        <span class="n">id_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id_column</span><span class="p">,</span>
        <span class="n">timestamp_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_column</span><span class="p">,</span>
        <span class="n">target_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span><span class="p">,</span>
        <span class="n">known_dynamic_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">known_dynamic_columns</span><span class="p">,</span>
        <span class="n">past_dynamic_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">past_dynamic_columns</span><span class="p">,</span>
        <span class="n">static_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">static_columns</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fev.Task.iter_windows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">iter_windows</span><span class="p">(</span><span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">EvaluationWindow</span><span class="p">]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Iterate over the rolling evaluation windows in the task.</p>
<p>Each window contains train/test splits at different cutoff points for time series
cross-validation. Use this method for model evaluation and benchmarking.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>storage_options</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Passed to <code>datasets.load_dataset()</code> for accessing remote datasets (e.g., S3 credentials).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trust_remote_code</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Passed to <code>datasets.load_dataset()</code> for trusting remote code from Hugging Face Hub.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_proc</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of processes to use for dataset preprocessing.</p>
              </div>
            </td>
            <td>
                  <code>DEFAULT_NUM_PROC</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EvaluationWindow


  
      dataclass
   (fev.task.EvaluationWindow)" href="../evaluation-window/#fev.EvaluationWindow">EvaluationWindow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single evaluation window at a specific cutoff containing the data needed to make and evaluate forecasts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">iter_windows</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">past_data</span><span class="p">,</span> <span class="n">future_data</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">get_input_data</span><span class="p">()</span>
<span class="gp">... </span>    <span class="c1"># Make predictions using past_data and future_data</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/fev/task.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">iter_windows</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">EvaluationWindow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the rolling evaluation windows in the task.</span>

<span class="sd">    Each window contains train/test splits at different cutoff points for time series</span>
<span class="sd">    cross-validation. Use this method for model evaluation and benchmarking.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    storage_options : dict, optional</span>
<span class="sd">        Passed to `datasets.load_dataset()` for accessing remote datasets (e.g., S3 credentials).</span>
<span class="sd">    trust_remote_code : bool, optional</span>
<span class="sd">        Passed to `datasets.load_dataset()` for trusting remote code from Hugging Face Hub.</span>
<span class="sd">    num_proc : int, default DEFAULT_NUM_PROC</span>
<span class="sd">        Number of processes to use for dataset preprocessing.</span>

<span class="sd">    Yields</span>
<span class="sd">    ------</span>
<span class="sd">    EvaluationWindow</span>
<span class="sd">        A single evaluation window at a specific cutoff containing the data needed to make and evaluate forecasts.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; for window in task.iter_windows():</span>
<span class="sd">    ...     past_data, future_data = window.get_input_data()</span>
<span class="sd">    ...     # Make predictions using past_data and future_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">window_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_windows</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span>
            <span class="n">window_idx</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fev.Task.evaluation_summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluation_summary</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]],</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">training_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inference_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">trained_on_this_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">extra_info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get a summary of the model performance for the given forecasting task.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>predictions_per_window</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="datasets.Dataset">Dataset</span> | <span title="list">list</span>[<span title="dict">dict</span>] | <span title="datasets.DatasetDict">DatasetDict</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="dict">dict</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predictions generated by the model for each evaluation window in the task.</p>
<p>The length of <code>predictions_per_window</code> must be equal to <code>task.num_windows</code>.</p>
<p>The predictions for each window must be formatted as described in <a class="autorefs autorefs-internal" title="clean_and_validate_predictions(predictions: datasets.DatasetDict | dict[str, list[dict]] | datasets.Dataset | list[dict]) -> datasets.DatasetDict" href="#fev.Task.clean_and_validate_predictions">clean_and_validate_predictions</a>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the model that generated the predictions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>training_time_s</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time of the model for this task (in seconds).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inference_time_s</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total inference time to generate all predictions (in seconds).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trained_on_this_dataset</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Was the model trained on the dataset associated with this task? Set to False if the model is used in
zero-shot mode.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_info</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary with additional information that will be appended to the evaluation summary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>summary</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary that summarizes the model performance on this task. Includes following keys:</p>
<ul>
<li><code>model_name</code> - name of the model</li>
<li><code>test_error</code> - value of the <code>task.eval_metric</code> averaged over all evaluation windows (lower is better)</li>
<li>all <code>Task</code> attributes obtained via <code>task.to_dict()</code>.</li>
<li>values of <code>task.extra_metrics</code> averaged all evaluation windows</li>
<li><code>dataset_fingerprint</code> - fingerprint of the dataset generated by the HF <code>datasets</code> library</li>
<li><code>trained_on_this_dataset</code> - whether the model was trained on the dataset used in the task</li>
<li><code>fev_version</code> - version of the <code>fev</code> package used to obtain the summary</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/fev/task.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluation_summary</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">predictions_per_window</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]],</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">training_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inference_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trained_on_this_dataset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">extra_info</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a summary of the model performance for the given forecasting task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    predictions_per_window : Iterable[datasets.Dataset | list[dict] | datasets.DatasetDict | dict[str, list[dict]]]</span>
<span class="sd">        Predictions generated by the model for each evaluation window in the task.</span>

<span class="sd">        The length of `predictions_per_window` must be equal to `task.num_windows`.</span>

<span class="sd">        The predictions for each window must be formatted as described in [clean_and_validate_predictions][fev.Task.clean_and_validate_predictions].</span>
<span class="sd">    model_name : str</span>
<span class="sd">        Name of the model that generated the predictions.</span>
<span class="sd">    training_time_s : float | None</span>
<span class="sd">        Training time of the model for this task (in seconds).</span>
<span class="sd">    inference_time_s : float | None</span>
<span class="sd">        Total inference time to generate all predictions (in seconds).</span>
<span class="sd">    trained_on_this_dataset : bool</span>
<span class="sd">        Was the model trained on the dataset associated with this task? Set to False if the model is used in</span>
<span class="sd">        zero-shot mode.</span>
<span class="sd">    extra_info : dict | None</span>
<span class="sd">        Optional dictionary with additional information that will be appended to the evaluation summary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : dict</span>
<span class="sd">        Dictionary that summarizes the model performance on this task. Includes following keys:</span>

<span class="sd">        - `model_name` - name of the model</span>
<span class="sd">        - `test_error` - value of the `task.eval_metric` averaged over all evaluation windows (lower is better)</span>
<span class="sd">        - all `Task` attributes obtained via `task.to_dict()`.</span>
<span class="sd">        - values of `task.extra_metrics` averaged all evaluation windows</span>
<span class="sd">        - `dataset_fingerprint` - fingerprint of the dataset generated by the HF `datasets` library</span>
<span class="sd">        - `trained_on_this_dataset` - whether the model was trained on the dataset used in the task</span>
<span class="sd">        - `fev_version` - version of the `fev` package used to obtain the summary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">}</span>
    <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_metric</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_metric</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_metrics</span><span class="p">]</span>
    <span class="n">eval_metric</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">metrics_per_window</span> <span class="o">=</span> <span class="p">{</span><span class="n">metric</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">,</span> <span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;predictions_per_window must be iterable (e.g., a list) but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="c1"># Use strict=True to raise error if num_predictions does not match num_windows</span>
    <span class="k">for</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">window</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions_per_window</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_windows</span><span class="p">(),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">metric_scores</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">compute_metrics</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clean_and_validate_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span>
            <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
            <span class="n">seasonality</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seasonality</span><span class="p">,</span>
            <span class="n">quantile_levels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quantile_levels</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metric_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">metrics_per_window</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="n">metrics_averaged</span> <span class="o">=</span> <span class="p">{</span><span class="n">metric_name</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">metrics_per_window</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;test_error&quot;</span><span class="p">:</span> <span class="n">metrics_averaged</span><span class="p">[</span><span class="n">eval_metric</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
            <span class="s2">&quot;training_time_s&quot;</span><span class="p">:</span> <span class="n">training_time_s</span><span class="p">,</span>
            <span class="s2">&quot;inference_time_s&quot;</span><span class="p">:</span> <span class="n">inference_time_s</span><span class="p">,</span>
            <span class="s2">&quot;dataset_fingerprint&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_fingerprint</span><span class="p">,</span>
            <span class="s2">&quot;trained_on_this_dataset&quot;</span><span class="p">:</span> <span class="n">trained_on_this_dataset</span><span class="p">,</span>
            <span class="s2">&quot;fev_version&quot;</span><span class="p">:</span> <span class="n">FEV_VERSION</span><span class="p">,</span>
            <span class="o">**</span><span class="n">metrics_averaged</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">extra_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra_info</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">summary</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fev.Task.clean_and_validate_predictions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clean_and_validate_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">|</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert predictions for a single window into the format needed for computing the metrics.</p>
<p>The following formats are supported for both multivariate and univariate tasks:</p>
<ul>
<li><code>DatasetDict</code>: Must contain a single key for each target in <code>task.target_columns</code>. Each value in
    the dict must be a <code>datasets.Dataset</code> with schema compatible with <code>task.predictions_schema</code>. This is the
    recommended format for providing predictions.</li>
<li><code>dict[str, list[dict]]</code>: A dictionary with one key for each target in <code>task.target_columns</code>. Each value in
    the dict must be a list of dictionaries, each dict following the schema in <code>task.predictions_schema</code>.</li>
</ul>
<p>Additionally for univariate tasks, the following formats are supported:</p>
<ul>
<li><code>datasets.Dataset</code>: A single <code>datasets.Dataset</code> with schema compatible with <code>task.predictions_schema</code>.</li>
<li><code>list[dict]</code>: A list of dictionaries, where each dict follows the schema in <code>task.predictions_schema</code>.</li>
</ul>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code><span title="datasets.DatasetDict">DatasetDict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>DatasetDict</code> where each key is the name of the target column and the corresponding value is a
<code>datasets.Dataset</code> with the predictions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/fev/task.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clean_and_validate_predictions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">|</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert predictions for a single window into the format needed for computing the metrics.</span>

<span class="sd">    The following formats are supported for both multivariate and univariate tasks:</span>

<span class="sd">    - `DatasetDict`: Must contain a single key for each target in `task.target_columns`. Each value in</span>
<span class="sd">        the dict must be a `datasets.Dataset` with schema compatible with `task.predictions_schema`. This is the</span>
<span class="sd">        recommended format for providing predictions.</span>
<span class="sd">    - `dict[str, list[dict]]`: A dictionary with one key for each target in `task.target_columns`. Each value in</span>
<span class="sd">        the dict must be a list of dictionaries, each dict following the schema in `task.predictions_schema`.</span>

<span class="sd">    Additionally for univariate tasks, the following formats are supported:</span>

<span class="sd">    - `datasets.Dataset`: A single `datasets.Dataset` with schema compatible with `task.predictions_schema`.</span>
<span class="sd">    - `list[dict]`: A list of dictionaries, where each dict follows the schema in `task.predictions_schema`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions :</span>
<span class="sd">        A `DatasetDict` where each key is the name of the target column and the corresponding value is a</span>
<span class="sd">        `datasets.Dataset` with the predictions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_to_dataset</span><span class="p">(</span><span class="n">preds</span><span class="p">:</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">preds</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">preds</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`datasets.Dataset.from_list(predictions)` failed. Please convert predictions to `datasets.Dataset` format.&quot;</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;predictions must be of type `datasets.Dataset` (received </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">preds</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">({</span><span class="n">col</span><span class="p">:</span> <span class="n">_to_dataset</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">preds</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)):</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">DatasetDict</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">_to_dataset</span><span class="p">(</span><span class="n">predictions</span><span class="p">)})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Expected predictions to be a `DatasetDict`, `Dataset`, `list` or `dict` (got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">missing_columns</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing predictions for columns </span><span class="si">{</span><span class="n">missing_columns</span><span class="si">}</span><span class="s2"> (got </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predictions_schema</span><span class="p">)</span><span class="o">.</span><span class="n">with_format</span><span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">predictions_for_column</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_all_columns_finite</span><span class="p">(</span><span class="n">predictions_for_column</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fev.Task.load_full_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_full_dataset</span><span class="p">(</span><span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load the full raw dataset with preprocessing applied.</p>
<p>This method validates the data, loads and preprocesses the dataset according to the task configuration,
including generating univariate targets if <code>generate_univariate_targets_from</code> is provided.</p>
<p><strong>Note:</strong> This method is only provided for information and debugging purposes. For model evaluation, use
<a class="autorefs autorefs-internal" title="iter_windows(storage_options: dict | None = None, trust_remote_code: bool | None = None, num_proc: int = DEFAULT_NUM_PROC) -> Iterable[EvaluationWindow]" href="#fev.Task.iter_windows"><code>iter_windows()</code></a> instead to get properly split train/test data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>storage_options</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Passed to <code>datasets.load_dataset()</code> for accessing remote datasets (e.g., S3 credentials).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trust_remote_code</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Passed to <code>datasets.load_dataset()</code> for trusting remote code from Hugging Face Hub.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_proc</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of processes to use for dataset preprocessing.</p>
              </div>
            </td>
            <td>
                  <code>DEFAULT_NUM_PROC</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="datasets.Dataset">Dataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The preprocessed dataset with all time series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/fev/task.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_full_dataset</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">storage_options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_proc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_NUM_PROC</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datasets</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the full raw dataset with preprocessing applied.</span>

<span class="sd">    This method validates the data, loads and preprocesses the dataset according to the task configuration,</span>
<span class="sd">    including generating univariate targets if `generate_univariate_targets_from` is provided.</span>

<span class="sd">    **Note:** This method is only provided for information and debugging purposes. For model evaluation, use</span>
<span class="sd">    [`iter_windows()`][fev.Task.iter_windows] instead to get properly split train/test data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    storage_options : dict, optional</span>
<span class="sd">        Passed to `datasets.load_dataset()` for accessing remote datasets (e.g., S3 credentials).</span>
<span class="sd">    trust_remote_code : bool, optional</span>
<span class="sd">        Passed to `datasets.load_dataset()` for trusting remote code from Hugging Face Hub.</span>
<span class="sd">    num_proc : int, default DEFAULT_NUM_PROC</span>
<span class="sd">        Number of processes to use for dataset preprocessing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    datasets.Dataset</span>
<span class="sd">        The preprocessed dataset with all time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_dataset</span><span class="p">(</span>
            <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">num_proc</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_dataset</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fev.Task.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert task definition to a dictionary.</p>


            <details class="quote">
              <summary>Source code in <code>src/fev/task.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert task definition to a dictionary.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>